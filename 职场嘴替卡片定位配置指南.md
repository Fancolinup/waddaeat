# 职场嘴替页面卡片定位配置指南

## 核心逻辑文件位置

### 1. 主要文件结构
- **页面逻辑**: `pages/voice/index.js` (544行)
- **页面结构**: `pages/voice/index.wxml` (172行)
- **页面样式**: `pages/voice/index.wxss` (708行)

### 2. 卡片定位核心代码位置

#### JavaScript 逻辑 (`pages/voice/index.js`)

**卡片位置数据定义** (第18-24行):
```javascript
// 卡片位置和动画（用于movable-view）
cardX: 0,
cardY: 0,
cardAnimation: false,
```

**触摸事件处理** (第147-207行):
- `onCardTouchStart` (第147行): 触摸开始事件
- `onCardTouchMove` (第158行): 触摸移动事件，实时更新卡片位置
- `onCardMove` (第208行): movable-view的bindchange事件处理

**卡片位置重置** (第404-427行):
```javascript
resetCardPosition: function() {
  this.setData({
    // movable-view 归零 - 确保回到几何中心
    cardX: 0,
    cardY: 0,
    // ... 其他重置参数
  });
}
```

**下一张卡片切换** (第350-401行):
```javascript
nextCard: function() {
  // 重置所有状态包括位置
  this.setData({
    cardX: 0,
    cardY: 0,
    // ... 其他状态重置
  });
}
```

#### WXML 结构 (`pages/voice/index.wxml`)

**可移动区域配置** (第19-35行):
```xml
<movable-area class="card-area">
  <movable-view 
    class="card-view"
    direction="all"
    x="{{cardX}}"
    y="{{cardY}}"
    animation="{{cardAnimation}}"
    bindtouchstart="onCardTouchStart"
    catchtouchmove="onCardTouchMove"
    bindtouchend="onCardTouchEnd"
  >
```

#### WXSS 样式 (`pages/voice/index.wxss`)

**容器居中配置** (第46-53行):
```css
.card-container {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 30rpx 40rpx;
  position: relative;
}
```

**可移动区域样式** (第55-67行):
```css
.card-area {
  width: 100%;
  height: 700rpx;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-view {
  width: calc(100% - 60rpx);
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
```

**卡片内容样式** (第69-85行):
```css
.content-card {
  width: 100%;
  height: 100%;
  /* 居中相关样式 */
  margin: 0;
  transform-origin: center center;
}
```

## 手动调整卡片位置参数配置

### 1. 调整卡片容器尺寸

**修改位置**: `pages/voice/index.wxss` 第55-67行

```css
.card-area {
  width: 100%;           /* 可移动区域宽度 */
  height: 700rpx;        /* 可移动区域高度 - 调整此值改变卡片垂直位置范围 */
  /* 其他样式... */
}

.card-view {
  width: calc(100% - 60rpx);  /* 卡片视图宽度 - 调整60rpx改变水平边距 */
  height: 100%;               /* 卡片视图高度 */
  /* 其他样式... */
}
```

### 2. 调整卡片内容边距

**修改位置**: `pages/voice/index.wxss` 第69-85行

```css
.content-card {
  padding: 60rpx 40rpx;  /* 内边距 - 调整此值改变卡片内容与边框的距离 */
  margin: 0;             /* 外边距 - 保持为0确保居中 */
  /* 其他样式... */
}
```

### 3. 调整整体容器位置

**修改位置**: `pages/voice/index.wxss` 第46-53行

```css
.card-container {
  padding: 30rpx 40rpx;  /* 容器内边距 - 调整此值改变卡片相对于屏幕的位置 */
  /* 其他样式... */
}
```

### 4. 程序化调整初始位置

**修改位置**: `pages/voice/index.js` 第18-24行

```javascript
data: {
  // 如需调整初始位置，修改这些默认值
  cardX: 0,    // 水平偏移，正值向右，负值向左
  cardY: 0,    // 垂直偏移，正值向下，负值向上
  // 其他数据...
}
```

### 5. 调整动画和交互参数

**修改位置**: `pages/voice/index.js` 第158-207行

```javascript
// 在onCardTouchMove方法中调整视觉反馈参数
const rotate = deltaX * 0.06;        // 旋转系数，调整此值改变旋转敏感度
const maxScaleDrop = 0.06;           // 最大缩放降幅
const scale = 1 - Math.min(Math.abs(deltaX) / 800, maxScaleDrop);  // 缩放计算
const opacity = 1 - Math.min(Math.abs(deltaX) / 600, 0.25);        // 透明度计算
```

**修改位置**: `pages/voice/index.js` 第244-264行

```javascript
// 在onCardTouchEnd方法中调整触发阈值
const threshold = 100;  // 滑动触发阈值，调整此值改变滑动敏感度
```

## 居中验证方法

### 1. 视觉检查
- 卡片的几何中心应与屏幕中心完全重合
- 卡片左右边距应相等
- 卡片上下在可视区域内居中

### 2. 代码验证
可以在 `resetCardPosition` 方法中添加调试代码:

```javascript
resetCardPosition: function() {
  console.log('重置卡片到中心位置: cardX=0, cardY=0');
  // 原有代码...
}
```

## 常见问题解决

### 1. 卡片偏左或偏右
- 检查 `.card-view` 的 `width` 计算
- 调整 `calc(100% - 60rpx)` 中的 `60rpx` 值

### 2. 卡片偏上或偏下
- 检查 `.card-container` 的 `padding` 设置
- 调整 `.card-area` 的 `height` 值

### 3. 卡片内容不居中
- 检查 `.content-card` 的 `margin` 是否为 `0`
- 确认 `transform-origin` 设置为 `center center`

### 4. 动画回弹不到中心
- 确认 `cardX` 和 `cardY` 重置为 `0`
- 检查 `animation` 属性是否正确绑定

## 修改建议

1. **保持响应式**: 使用相对单位(rpx, %)而非绝对像素值
2. **测试多设备**: 在不同屏幕尺寸设备上验证居中效果
3. **渐进调整**: 每次只调整一个参数，观察效果后再继续
4. **备份原值**: 修改前记录原始参数值，便于回滚

---

**最后更新**: 2024年12月19日
**适用版本**: 微信小程序基础库 2.0+