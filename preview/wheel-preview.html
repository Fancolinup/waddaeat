<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wheel Preview - 今日选择</title>
  <script src="../shareWording.js"></script>
  <style>
    :root { --rpx: 1px; }
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif; background: #f7f8fa; }
    .page { min-height: 100vh; padding: 20px 20px 120px; background:
      radial-gradient(120% 120% at 0% 0%, #e6f0ff 0%, rgba(255,255,255,0.9) 40%),
      radial-gradient(120% 120% at 100% 0%, #ffe6f0 0%, rgba(255,255,255,0.9) 40%),
      radial-gradient(120% 120% at 50% 100%, #e8fff3 0%, rgba(255,255,255,0.9) 40%); }
    .header { display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 8px; }
    .title { font-size: 24px; font-weight: 700; color: #111; }
    .controls { display: flex; gap: 12px; align-items: center; }
    .controls select { padding: 6px 10px; border-radius: 8px; border: 1px solid #e5e7eb; background: #fff; }

    .wheel-wrapper { position: relative; margin: 20px auto 20px; width: 620px; height: 620px; max-width: 92vw; max-height: 92vw; }
    .pointer { position: absolute; left: 50%; top: -10px; transform: translateX(-50%); width: 0; height: 0; border-left: 18px solid transparent; border-right: 18px solid transparent; border-bottom: 36px solid #ff4d4f; filter: drop-shadow(0 6px 8px rgba(0,0,0,0.15)); z-index: 3; }

    /* Base wheel */
    .wheel { position: relative; width: 100%; height: 100%; border-radius: 50%; box-shadow: inset 0 0 0 16px rgba(255,255,255,0.7), 0 20px 40px rgba(0,0,0,0.12); transition: transform 2.8s cubic-bezier(.24,.8,.26,1); overflow: hidden; }

    /* Palette A: Modern Neutrals */
    .wheel.palette-a { background: conic-gradient(
      #0f172a 0 30deg, #1f2937 30deg 60deg, #374151 60deg 90deg, #4b5563 90deg 120deg,
      #6b7280 120deg 150deg, #94a3b8 150deg 180deg, #cbd5e1 180deg 210deg, #e2e8f0 210deg 240deg,
      #9ca3af 240deg 270deg, #64748b 270deg 300deg, #475569 300deg 330deg, #334155 330deg 360deg
    ); }

    /* Palette B: Warm Sandstone */
    .wheel.palette-b { background: conic-gradient(
      #7f5539 0 30deg, #9c6644 30deg 60deg, #b08968 60deg 90deg, #ddb892 90deg 120deg,
      #e6ccb2 120deg 150deg, #a68a64 150deg 180deg, #936639 180deg 210deg, #b07d62 210deg 240deg,
      #c89f77 240deg 270deg, #e0bfa5 270deg 300deg, #a98467 300deg 330deg, #8c6a5d 330deg 360deg
    ); }

    /* Palette C: Pastel Luxe */
    .wheel.palette-c { background: conic-gradient(
      #c7d2fe 0 30deg, #bfdbfe 30deg 60deg, #a7f3d0 60deg 90deg, #fbcfe8 90deg 120deg,
      #fde68a 120deg 150deg, #a5f3fc 150deg 180deg, #ddd6fe 180deg 210deg, #bae6fd 210deg 240deg,
      #bbf7d0 240deg 270deg, #f5d0fe 270deg 300deg, #fef3c7 300deg 330deg, #cffafe 330deg 360deg
    ); }

    /* Palette D: Cool Breeze */
    .wheel.palette-d { background: conic-gradient(
      #0ea5e9 0 30deg, #06b6d4 30deg 60deg, #14b8a6 60deg 90deg, #22c55e 90deg 120deg,
      #2dd4bf 120deg 150deg, #38bdf8 150deg 180deg, #60a5fa 180deg 210deg, #3b82f6 210deg 240deg,
      #2563eb 240deg 270deg, #1d4ed8 270deg 300deg, #0891b2 300deg 330deg, #0f766e 330deg 360deg
    ); }

    /* Palette E: Citrus Punch */
    .wheel.palette-e { background: conic-gradient(
      #ef4444 0 30deg, #f97316 30deg 60deg, #f59e0b 60deg 90deg, #eab308 90deg 120deg,
      #84cc16 120deg 150deg, #10b981 150deg 180deg, #34d399 180deg 210deg, #22c55e 210deg 240deg,
      #a3e635 240deg 270deg, #fde047 270deg 300deg, #fb923c 300deg 330deg, #f43f5e 330deg 360deg
    ); }

    /* Palette F: Sakura Pastel */
    .wheel.palette-f { background: conic-gradient(
      #ffe4e6 0 30deg, #fecdd3 30deg 60deg, #fbcfe8 60deg 90deg, #e9d5ff 90deg 120deg,
      #dbeafe 120deg 150deg, #bae6fd 150deg 180deg, #bbf7d0 180deg 210deg, #dcfce7 210deg 240deg,
      #fef9c3 240deg 270deg, #ffedd5 270deg 300deg, #fde68a 300deg 330deg, #c7d2fe 330deg 360deg
    ); }

    /* Palette G: Neo Pop High Contrast */
    .wheel.palette-g { background: conic-gradient(
      #111827 0 30deg, #f59e0b 30deg 60deg, #0ea5e9 60deg 90deg, #ef4444 90deg 120deg,
      #10b981 120deg 150deg, #a855f7 150deg 180deg, #f43f5e 180deg 210deg, #22c55e 210deg 240deg,
      #eab308 240deg 270deg, #3b82f6 240deg 300deg, #fb7185 300deg 330deg, #9333ea 330deg 360deg
    ); }

    /* Palette H: Classic Primary Bold */
    .wheel.palette-h { background: conic-gradient(
      #e11d48 0 30deg, #ea580c 30deg 60deg, #f59e0b 60deg 90deg, #84cc16 90deg 120deg,
      #16a34a 120deg 150deg, #0ea5e9 150deg 180deg, #2563eb 180deg 210deg, #1d4ed8 210deg 240deg,
      #9333ea 240deg 270deg, #7e22ce 270deg 300deg, #db2777 300deg 330deg, #be123c 330deg 360deg
    ); }

    .wheel-center { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 180px; height: 180px; border-radius: 50%; background: rgba(255,255,255,0.85); display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 24px rgba(16, 38, 73, 0.12), inset 0 0 0 8px rgba(255,255,255,0.7); }
    .spin-btn { background: #111; color: #fff; border-radius: 999px; padding: 12px 28px; font-weight: 600; border: none; cursor: pointer; }

    .wheel-item { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform-origin: 50% 50%; }
    /* radial character style */
    .ch { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 18px; color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.35), 0 2px 8px rgba(0,0,0,0.15); -webkit-text-stroke: 0.6px rgba(0,0,0,0.2); }
    .font-1 { font-family: 'PingFang SC','Hiragino Sans GB','Microsoft YaHei','Noto Sans SC',sans-serif; font-weight: 800; letter-spacing: 0.5px; }
    .font-2 { font-family: 'Songti SC','Noto Serif SC','STSong',serif; font-weight: 700; letter-spacing: 0.8px; }
    .font-3 { font-family: 'Kaiti SC','STKaiti','HanziPen SC','Hannotate SC',cursive; font-weight: 700; letter-spacing: 0.5px; }
    .font-4 { font-family: 'SF Pro Rounded','Helvetica Neue','Arial Rounded MT Bold','PingFang SC',sans-serif; font-weight: 800; letter-spacing: 0.4px; }
    /* Optional gradient text look */
    .accent { background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.75)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: none; -webkit-text-stroke: 0.8px rgba(0,0,0,0.3); }

    .glass { background: rgba(255,255,255,0.8); border-radius: 24px; box-shadow: 0 8px 30px rgba(0,0,0,0.08); backdrop-filter: blur(20px); }
    .decision-card { padding: 24px; margin: 20px 0; }
    .restaurant-row { display: flex; align-items: center; gap: 20px; }
    .rest-logo { width: 100px; height: 100px; border-radius: 20px; object-fit: contain; }
    .rest-info { flex: 1; }
    .rest-name { font-size: 22px; font-weight: 700; color: #111; }
    .rest-type { font-size: 14px; color: #666; margin-top: 4px; }
    .rest-promo { font-size: 14px; color: #444; margin-top: 8px; }
    .action-row { display: flex; gap: 16px; margin-top: 20px; }
    .btn { padding: 14px 24px; border-radius: 16px; background: #eff1f5; color: #111; border: none; cursor: pointer; }
    .btn.primary { background: #2563eb; color: #fff; }

    .shortlist { padding: 20px; }
    .shortlist-title { font-size: 18px; color: #111; margin-bottom: 12px; }
    .shortlist-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    .short-item { position: relative; height: 140px; border-radius: 16px; background: rgba(255,255,255,0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .short-item.placeholder { border: 2px dashed rgba(0,0,0,0.08); background: transparent; }
    .short-icon { width: 64px; height: 64px; object-fit: contain; }
    .short-name { font-size: 14px; color: #333; margin-top: 6px; max-width: 140px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden; }
    .short-remove { position: absolute; right: 8px; top: 2px; color: #888; cursor: pointer; }

    .share-bar { position: fixed; left: 20px; right: 20px; bottom: 20px; padding: 18px 20px; display: flex; align-items: center; justify-content: space-between; }
    .share-text { font-size: 14px; color: #222; flex: 1; margin-right: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* --- 新增：切换按钮CSS图标候选展示 --- */
    .icon-gallery { margin: 20px 0 10px; }
    .icon-gallery h2 { font-size: 18px; color: #111; margin: 0 0 8px; }
    .icon-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
    .icon-tile { width: 56px; height: 56px; border-radius: 14px; display: flex; align-items: center; justify-content: center; position: relative; box-shadow: 0 6px 16px rgba(0,0,0,0.08); }
    .style-a { background: linear-gradient(135deg, #dff2ff, #f0fffb); color: #0b4a6f; }
    .style-b { background: linear-gradient(135deg, #222, #444); color: #ffffff; }
    .style-c { background: linear-gradient(135deg, #667eea, #764ba2); color: #ffffff; }
    /* 形状：与小程序中的 icon-plate / icon-bag / icon-cup 相似的CSS绘制 */
    .icon-shape { width: 40px; height: 40px; position: relative; }
    /* 餐盘 */
    .demo-plate::before { content:""; position:absolute; left:50%; top:50%; width:34px; height:34px; border-radius:50%; background: radial-gradient(circle at 50% 50%, currentColor 0 60%, rgba(255,255,255,0.6) 60% 100%); transform: translate(-50%, -50%); }
    .demo-plate::after { content:""; position:absolute; left:50%; top:50%; width:22px; height:10px; background: linear-gradient(90deg, transparent 0 15%, #fff 15% 35%, transparent 35% 65%, #fff 65% 85%, transparent 85%); transform: translate(-50%, -50%); border-radius:6px; }
    /* 外卖袋 */
    .demo-bag::before { content:""; position:absolute; left:50%; top:50%; width:26px; height:28px; background:#fff; border-radius:6px; transform: translate(-50%, -45%); box-shadow: inset 0 -6px 0 rgba(0,0,0,0.08); }
    .demo-bag::after { content:""; position:absolute; left:50%; top:50%; width:18px; height:10px; border:4px solid #fff; border-bottom:none; border-radius:16px 16px 0 0; transform: translate(-50%, -80%); }
    /* 饮料杯 */
    .demo-cup::before { content:""; position:absolute; left:50%; top:50%; width:26px; height:30px; background:#fff; border-radius:4px; transform: translate(-50%, -45%); }
    .demo-cup::after { content:""; position:absolute; left:50%; top:50%; width:4px; height:18px; background:#fff; transform: translate(-10px, -80%); border-radius:2px; }
  </style>
</head>
<body>
  <div class="page">
    <div class="header">
      <div class="title">今天吃什么？ — 字体/配色 预览</div>
      <div class="controls">
        <label>字体方案：
          <select id="fontSelect">
            <option value="font-1">方案 A · 现代黑体（粗重）</option>
            <option value="font-2">方案 B · 雅致宋体（衬线）</option>
            <option value="font-3">方案 C · 书法楷体（手写）</option>
            <option value="font-4">方案 D · 圆体（现代）</option>
            <option value="accent">方案 E · 渐变描边（强调）</option>
          </select>
        </label>
        <label>配色方案：
          <select id="paletteSelect">
            <option value="palette-a">A · Modern Neutrals</option>
            <option value="palette-b">B · Warm Sandstone</option>
            <option value="palette-c">C · Pastel Luxe</option>
            <option value="palette-d">D · Cool Breeze（冷调清爽）</option>
            <option value="palette-e">E · Citrus Punch（柑橘活力）</option>
            <option value="palette-f">F · Sakura Pastel（樱花马卡龙）</option>
            <option value="palette-g">G · Neo Pop（高对比霓虹）</option>
            <option value="palette-h">H · Classic Primary（经典原色）</option>
          </select>
        </label>
        <button class="btn" id="reroll">再来一次</button>
      </div>
    </div>

    <div class="wheel-wrapper">
      <div class="wheel palette-b" id="wheel">
        <!-- labels will be inserted by JS -->
        <div class="wheel-center"><button id="spinBtn" class="spin-btn">开始</button></div>
      </div>
      <div class="pointer"></div>
    </div>

    <div class="decision-card glass" id="decision" style="display:none;">
      <div class="restaurant-row">
        <img class="rest-logo" id="restLogo" src="cloud://cloud1-4gw154ajfc4d5163.636c-cloud1-4gw154ajfc4d5163-1379600796/FullRest/placeholder.png" />
        <div class="rest-info">
          <div class="rest-name" id="restName">-</div>
          <div class="rest-type" id="restType">餐厅</div>
          <div class="rest-promo" id="restPromo">优惠信息：敬请期待</div>
        </div>
      </div>
      <div class="action-row">
        <button class="btn primary">就它了</button>
        <button class="btn" id="reroll2">再来一次</button>
        <button class="btn">加入备选</button>
      </div>
    </div>

    <div class="shortlist glass">
      <div class="shortlist-title">备选</div>
      <div class="shortlist-grid">
        <div class="short-item placeholder"></div>
        <div class="short-item placeholder"></div>
        <div class="short-item placeholder"></div>
        <div class="short-item placeholder"></div>
      </div>
    </div>

    <div class="share-bar glass">
      <div class="share-text" id="shareText">今天吃什么？</div>
      <button class="btn" id="copyBtn">复制</button>
    </div>
  </div>

  <script>
    const wheel = document.getElementById('wheel');
    const spinBtn = document.getElementById('spinBtn');
    const rerollBtn = document.getElementById('reroll');
    const rerollBtn2 = document.getElementById('reroll2');
    const shareTextEl = document.getElementById('shareText');
    const decision = document.getElementById('decision');
    const restNameEl = document.getElementById('restName');
    const restLogoEl = document.getElementById('restLogo');
    const fontSelect = document.getElementById('fontSelect');
    const paletteSelect = document.getElementById('paletteSelect');

    const names = [
      '麦当劳','肯德基','星巴克','汉堡王','喜茶','呷哺呷哺','海底捞','西贝莜面村','沃歌斯','莆田餐厅','小杨生煎','鹿港小镇'
    ];
    const wheelRadius = 260; // px

    // set default to palette B and font A
    paletteSelect.value = 'palette-b';
    fontSelect.value = 'font-1';

    function clearItems(){
      Array.from(wheel.querySelectorAll('.wheel-item')).forEach(el => el.remove());
    }

    function renderItems() {
      clearItems();
      const step = 360 / names.length;
      const fontClass = fontSelect.value || 'font-1';
      const labelStart = 90; // px from center
      const labelOuterMargin = 30; // px from outer edge
      const available = Math.max(0, wheelRadius - labelOuterMargin - labelStart);
      names.forEach((name, idx) => {
        const angle = idx * step;
        const item = document.createElement('div');
        item.className = 'wheel-item';
        item.style.transform = `rotate(${angle}deg)`;

        const chars = Array.from(name);
        const rawStep = chars.length > 1 ? Math.floor(available / (chars.length - 1)) : available;
        const labelStep = Math.min(30, rawStep);
        chars.forEach((ch, cidx) => {
          const el = document.createElement('div');
          el.className = `ch ${fontClass}`;
          el.textContent = ch;
          el.style.transform = `translate(-50%, -50%) translateY(-${labelStart + cidx * labelStep}px)`;
          item.appendChild(el);
        });

        wheel.appendChild(item);
      });
    }

    let rotateDeg = 0;
    function pickShareText(restaurant) {
      try {
        const list = (typeof shareWording !== 'undefined' && Array.isArray(shareWording)) ? shareWording : [];
        if (Array.isArray(list) && list.length) {
          const tpl = list[Math.floor(Math.random()*list.length)] || '';
          shareTextEl.textContent = tpl.replace('{restaurant}', restaurant || '它');
          return;
        }
      } catch (_) {}
      // 回退：尝试 JSON 文件或默认文案
      fetch('/shareWording.json').then(r => r.json()).then(list => {
        if (Array.isArray(list) && list.length) {
          const tpl = list[Math.floor(Math.random()*list.length)] || '';
          shareTextEl.textContent = tpl.replace('{restaurant}', restaurant || '它');
        } else {
          shareTextEl.textContent = '今天吃什么？';
        }
      }).catch(() => {
        shareTextEl.textContent = '今天吃什么？';
      });
    }

    function onSpin() {
      const count = names.length;
      const step = 360 / count;
      const targetIndex = Math.floor(Math.random() * count);
      const targetAngle = 360 * 5 + (360 - targetIndex * step - step/2);
      rotateDeg += targetAngle; // 累积，保持方向一致
      wheel.style.transform = `rotate(${rotateDeg}deg)`;
      setTimeout(() => {
        const hit = names[targetIndex];
        decision.style.display = 'block';
        restNameEl.textContent = hit;
        pickShareText(hit);
      }, 2800);
    }

    renderItems();
    pickShareText('它');
    spinBtn.addEventListener('click', onSpin);
    rerollBtn.addEventListener('click', onSpin);
    rerollBtn2.addEventListener('click', onSpin);

    fontSelect.addEventListener('change', renderItems);
    paletteSelect.addEventListener('change', () => {
      wheel.classList.remove('palette-a','palette-b','palette-c','palette-d','palette-e','palette-f','palette-g','palette-h');
      wheel.classList.add(paletteSelect.value);
    });

    document.getElementById('copyBtn').addEventListener('click', () => {
      const text = shareTextEl.textContent || '';
      navigator.clipboard.writeText(text).then(()=> alert('已复制')).catch(()=> alert('复制失败'));
    });
  </script>
</body>
</html>

<!-- 新增：切换按钮CSS图标候选展示（3套风格 × 3类型） -->
<div class="icon-gallery glass">
  <h2>切换按钮 CSS 图标候选</h2>
  <div class="icon-grid">
    <!-- 风格A：浅色渐变，参考个人页卡片背景 -->
    <div class="icon-tile style-a"><div class="icon-shape demo-plate" aria-label="餐厅-风格A"></div></div>
    <div class="icon-tile style-a"><div class="icon-shape demo-bag" aria-label="外卖-风格A"></div></div>
    <div class="icon-tile style-a"><div class="icon-shape demo-cup" aria-label="茶饮-风格A"></div></div>
    <!-- 风格B：深色渐变，当前切换条选中态风格 -->
    <div class="icon-tile style-b"><div class="icon-shape demo-plate" aria-label="餐厅-风格B"></div></div>
    <div class="icon-tile style-b"><div class="icon-shape demo-bag" aria-label="外卖-风格B"></div></div>
    <div class="icon-tile style-b"><div class="icon-shape demo-cup" aria-label="茶饮-风格B"></div></div>
    <!-- 风格C：品牌色渐变（紫蓝），与当前active状态一致的明亮方案 -->
    <div class="icon-tile style-c"><div class="icon-shape demo-plate" aria-label="餐厅-风格C"></div></div>
    <div class="icon-tile style-c"><div class="icon-shape demo-bag" aria-label="外卖-风格C"></div></div>
    <div class="icon-tile style-c"><div class="icon-shape demo-cup" aria-label="茶饮-风格C"></div></div>
  </div>
</div>