<!--pages/welcome/welcome.wxml-->
<!--新用户欢迎页面 - 品牌选择-->
<view class="welcome-container">
  <!-- 背景渐变 -->
  <view class="background-gradient"></view>
  
  <!-- 顶部文案区 -->
  <view class="header-section">
    <text class="main-title">欢迎，请选择常去的餐厅</text>
    <view class="selection-counter">
      <text class="counter-text">已选择 {{selectedRestaurants.length}} 家餐厅</text>
    </view>
  </view>
  
  <!-- 品牌选择区 -->
  <view class="brand-selection-area">
    <view wx:if="{{isLoading}}" class="loading-container">
      <text class="loading-text">正在加载餐厅数据...</text>
    </view>
    
    <view wx:else class="restaurant-selection">
      <scroll-view class="restaurant-scroll" scroll-y="true" enhanced="true" show-scrollbar="false" scroll-with-animation="true">
        <!-- 3列网格布局 -->
        <view class="grid-layout">
          <view 
            wx:for="{{restaurants}}" 
            wx:key="sid" 
            class="restaurant-item {{item.selected ? 'selected' : ''}}"
            data-id="{{item.sid}}"
            bindtap="onRestaurantTap"
          >
            <view class="restaurant-logo">
              <!-- 自定义餐厅显示emoji -->
              <view wx:if="{{item.category === '自定义'}}" class="emoji-placeholder">
                <text class="emoji-text">🍽️</text>
              </view>
              <!-- 普通餐厅显示图片 -->
              <image wx:else
                src="{{item.logoPath}}"
                mode="aspectFill"
                class="logo-image"
                binderror="onImageError"
                data-id="{{item.sid}}"
              />
              <!-- 新餐厅角标 -->
              <view wx:if="{{item.isNew}}" class="new-badge">
                <text class="new-text">New</text>
              </view>
            </view>
            <!-- 餐厅名称显示（统一显示） -->
            <view class="restaurant-name-display">
              <text class="restaurant-name-text">{{item.name}}</text>
            </view>
          </view>

          <!-- 列表末尾功能单元格：添加餐厅，与底部按钮一致的功能 -->
          <view class="restaurant-item more-restaurant-item" bindtap="onAddCustomRestaurant">
            <view class="restaurant-logo">
              <view class="emoji-placeholder">
                <text class="emoji-text">＋</text>
              </view>
            </view>
            <view class="restaurant-name-display">
              <text class="restaurant-name-text">添加餐厅</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>
  

  <!-- 添加餐厅入口 -->
  <view class="add-restaurant-section">
    <view class="add-restaurant-btn" bindtap="onAddCustomRestaurant">
      <view class="add-icon">+</view>
      <text class="add-text">添加餐厅</text>
    </view>
  </view>
  
  <!-- 底部操作区 -->
  <view class="bottom-actions">
    <button 
      class="complete-btn {{selectedRestaurants.length > 0 ? 'active' : 'disabled'}}"
      bindtap="onCompleteSelection"
      disabled="{{selectedRestaurants.length === 0}}"
    >
      确认选择
    </button>
  </view>
</view>